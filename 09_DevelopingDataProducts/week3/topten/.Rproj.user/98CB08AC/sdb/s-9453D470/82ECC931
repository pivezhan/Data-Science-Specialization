{
    "contents" : "\n## normal distribution with different degree of freedom\nlibrary(ggplot2); library(manipulate)\nk <- 1000\nxvals <- seq(-5, 5, length = k)\nmyplot <- function(df){\n        d <- data.frame(y = c(dnorm(xvals), dt(xvals, df)),\n                        x = xvals,\n                        dist = factor(rep(c(\"Normal\", \"T\"), c(k,k))))\n        g <- ggplot(d, aes(x = x, y = y)) \n        g <- g + geom_line(size = 2, aes(colour = dist))\n        g\n}\nmanipulate(myplot(mu), mu = slider(1, 20, step = 1))  \n\n## evaluation of quantiles\nlibrary(ggplot2); library(manipulate)\n\npvals <- seq(.5, .99, by = .01)\nmyplot2 <- function(df){\n        d <- data.frame(n= qnorm(pvals),t=qt(pvals, df),\n                        p = pvals)\n        g <- ggplot(d, aes(x= n, y = t))\n        g <- g + geom_abline(size = 2, col = \"lightblue\")\n        g <- g + geom_line(size = 2, col = \"black\")\n        g <- g + geom_vline(xintercept = qnorm(0.975))\n        g <- g + geom_hline(yintercept = qt(0.975, df))\n        g\n}\nmanipulate(myplot2(df), df = slider(1, 20, step = 1))\n\n##sleep data\ndata(sleep)\nhead(sleep)\n\n##plotting the data\nlibrary(ggplot2)\ng <- ggplot(sleep, aes(x = group, y = extra, group = factor(ID)))\ng <- g + geom_line(size = 1, aes(colour = ID)) + geom_point(size =10, pch = 21, fill = \"salmon\", alpha = .5)\ng\n\n##results\ng1 <- sleep$extra[1 : 10]; g2 <- sleep$extra[11 : 20]\ndifference <- g2 - g1\nmn <- mean(difference); s <- sd(difference); n <- 10\n\nmn + c(-1, 1) * qt(.975, n-1) * s / sqrt(n)##c(-1,1) means +/- equation\nt.test(difference)\nt.test(g2, g1, paired = TRUE)\nt.test(extra ~ I(relevel(group, 2)), paired = TRUE, data = sleep)\n\nrbind(\n        mn + c(-1, 1) * qt(.975, n-1) * s / sqrt(n),\n        as.vector(t.test(difference)$conf.int),\n        as.vector(t.test(g2, g1, paired = TRUE)$conf.int),\n        as.vector(t.test(extra ~ I(relevel(group, 2)), paired = TRUE, data = sleep)$conf.int)\n)\n\n##example\nsp <- sqrt((7 * 15.34^2 + 20 * 18.23^2) / (8 + 21 - 2))\n132.86 - 127.44 + c(-1, 1) * qt(.975, 27) * sp * (1 / 8 + 1 / 21)^.5\n\n# Mistakenly treating the sleep data as grouped\ng1 <- sleep$extra[1 : 10]; g2 <- sleep$extra[11 : 20]\nn1 <- length(g1); n2 <- length(g2)\nsp <- sqrt( ((n1 - 1) * sd(g1)^2 + (n2-1) * sd(g2)^2) / (n1 + n2-2))\nmd <- mean(g2) - mean(g1)\nsemd <- sp * sqrt(1 / n1 + 1/n2)\nrbind(\n        md + c(-1, 1) * qt(.975, n1 + n2 - 2) * semd,  \n        t.test(g2, g1, paired = FALSE, var.equal = TRUE)$conf,\n        t.test(g2, g1, paired = TRUE)$conf\n)\n\n# Grouped versus independent\nlibrary(ggplot2)\ng <- ggplot(sleep, aes(x = group, y = extra, group = factor(ID)))\ng <- g + geom_line(size = 1, aes(colour = ID)) + geom_point(size =10, pch = 21, fill = \"salmon\", alpha = .5)\ng\n\n## ChickWeight data in R\nlibrary(datasets); data(ChickWeight); library(reshape2)\n\n##define weight gain or loss\nwideCW <- dcast(ChickWeight, Diet + Chick ~ Time, value.var = \"weight\")\nnames(wideCW)[-(1 : 2)] <- paste(\"time\", names(wideCW)[-(1 : 2)], sep = \"\")\nlibrary(dplyr)\nwideCW <- mutate(wideCW,\n                 gain = time21 - time0)\n\n# Plotting the raw data\ng <- ggplot(ChickWeight, aes(x = Time, y = weight, \n                             colour = Diet, group = Chick))\ng <- g + geom_line()\ng <- g + stat_summary(aes(group = 1), geom = \"line\", fun.y = mean, size = 1, col = \"black\")\ng <- g + facet_grid(. ~ Diet)\ng\n\n# Weight gain by diet\n\ng <- ggplot(wideCW, aes(x = factor(Diet), y = gain, fill = factor(Diet)))\ng <- g + geom_violin(col = \"black\", size = 2)\ng\n\n\n## t interval\nwideCW14 <- subset(wideCW, Diet %in% c(1, 4))\nrbind(\n        t.test(gain ~ Diet, paired = FALSE, var.equal = TRUE, data = wideCW14)$conf,\n        t.test(gain ~ Diet, paired = FALSE, var.equal = FALSE, data = wideCW14)$conf\n)\n\n# T test in R\nlibrary(UsingR); data(father.son)\nt.test(father.son$sheight - father.son$fheight)\n\n\n# chickWeight data\n# Recall that we reformatted this data\nlibrary(datasets); data(ChickWeight); library(reshape2)\n\n##define weight gain or loss\nwideCW <- dcast(ChickWeight, Diet + Chick ~ Time, value.var = \"weight\")\nnames(wideCW)[-(1 : 2)] <- paste(\"time\", names(wideCW)[-(1 : 2)], sep = \"\")\nlibrary(dplyr)\nwideCW <- mutate(wideCW,\n                 gain = time21 - time0\n)\n\n# Unequal variance T test comparing diets 1 and 4\nwideCW14 <- subset(wideCW, Diet %in% c(1, 4))\nt.test(gain ~ Diet, paired = FALSE, \n       var.equal = TRUE, data = wideCW14)\n\n# Revisiting an earlier example\nchoose(8, 7) * .5 ^ 8 + choose(8, 8) * .5 ^ 8 \npbinom(6, size = 8, prob = .5, lower.tail = FALSE)\n\n##poison example\nppois(9, 5, lower.tail = FALSE)\n",
    "created" : 1430399040525.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3519909851",
    "id" : "82ECC931",
    "lastKnownWriteTime" : 1430402963,
    "path" : "C:/Users/lenovo/Desktop/Rlearning/statistical inference/week3/statistical inferenceweek3.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}