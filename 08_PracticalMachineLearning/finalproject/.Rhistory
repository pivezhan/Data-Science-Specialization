ln(1)
?ln
log(1)
log(2.7172)
log(1)
log(1.0001)
log(1.0002)
log(1.00000001)
log(0.00000001)
file.path("D:", "sbu", "RLearning", "Getting and Cleaning Data",
"programming")
activity_labels<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming",UCI HAR Dataset,activity_labels.txt),
activity_labels<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming",UCI HAR Dataset,activity_labels.txt),
activity_labels<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming","UCI HAR Dataset","activity_labels.txt"),
col.names=c("ID1","activity"))
X_train<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming", "UCI HAR Dataset", "train", "X_train.txt"))
y_train<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming", "UCI HAR Dataset", "train", "y_train.txt"))
subject_test<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming", "UCI HAR Dataset", "test"))
X_test<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming", "UCI HAR Dataset", "test","X_test.txt"))
y_test<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming", "UCI HAR Dataset", "test","y_test.txt"))
activity_labels<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming","UCI HAR Dataset","activity_labels.txt"),
col.names=c("ID1","activity"))
features<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming", "UCI HAR Dataset", "features.txt"),
col.names=c("ID2","feature"))
subject_train<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming", "UCI HAR Dataset", "train", "subject_train.txt"))
X_train<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming", "UCI HAR Dataset", "train", "X_train.txt"))
y_train<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming", "UCI HAR Dataset", "train", "y_train.txt"))
subject_test<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming", "UCI HAR Dataset", "test"))
subject_test<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming", "UCI HAR Dataset", "test"))
subject_test<-read.table(file.path("D:", "sbu", "RLearning",
"Getting and Cleaning Data","programming", "UCI HAR Dataset", "test","subject_test.txt"))
subject_train<-read.table(file.path("D:", "sbu", "RLearning", "Getting and Cleaning Data",
"programming", "UCI HAR Dataset", "train", "subject_train.txt"), col.names="subject")
X_train<-read.table(file.path("D:", "sbu", "RLearning","Getting and Cleaning Data",
"programming", "UCI HAR Dataset", "train", "X_train.txt"), col.names=features$feature)
y_train<-read.table(file.path("D:", "sbu", "RLearning","Getting and Cleaning Data",
"programming", "UCI HAR Dataset", "train", "y_train.txt"), col.names="labels")
subject_test<-read.table(file.path("D:", "sbu", "RLearning", "Getting and Cleaning Data",
"programming", "UCI HAR Dataset", "test","subject_test.txt"), col.names="subject")
X_test<-read.table(file.path("D:", "sbu", "RLearning", "Getting and Cleaning Data",
"programming", "UCI HAR Dataset", "test","X_test.txt"), col.names=features$feature)
y_test<-read.table(file.path("D:", "sbu", "RLearning", "Getting and Cleaning Data",
"programming", "UCI HAR Dataset", "test","y_test.txt"), col.names="labels")
RenamedTrain<-cbind(subject_train,y_train,X_train[,allfeatures])
RenamedTest<-cbind(subject_test,y_test,X_test[,allfeatures])
MeanMeasurment<-features$feature[grep("mean",tolower(as.character(features$feature)))]
StdMeasurment<-features$feature[grep("std",tolower(as.character(features$feature)))]
allfeatures<-grep("mean|std",tolower(as.character(features$feature)))
RenamedTrain<-cbind(subject_train,y_train,X_train[,allfeatures])
RenamedTest<-cbind(subject_test,y_test,X_test[,allfeatures])
Renamedsubject<-rbind(RenamedTrain,RenamedTest)
Renamedsubject
names(Renamedsubject)
colnames(RenamedTrain)
colnames(features)
features$feature
RepairedNames1<-gsub("\\(\\)","",as.character(names(Renamedsubject)))
RepairedNames2<-gsub("\\.","",RepairedNames1)
RepairedNames3<-gsub("[0-9]","",RepairedNames2)
names(Renamedsubject)<-RepairedNames3
names(Renamedsubject)
Renamedsubject$subject
UniqueSubject
UniqueSubject
UniqueSubject<-unique(Renamedsubject$subject)
UniqueActivity<-length(unique(Renamedsubject$label))
SubjectFeatureMeans<-matrix(rep(0,
length(UniqueSubject)*UniqueActivity*(ncol(Renamedsubject))),
(length(UniqueSubject)*UniqueActivity),(ncol(Renamedsubject)))
for (i in 1:length(UniqueSubject)){
for (j in 1:UniqueActivity){
SubjectFeatureMeans[(((i-1)*UniqueActivity)+j),]<-
c(i,as.character(activity_labels$activity[j]),
sapply(Renamedsubject[(Renamedsubject$subject==
UniqueSubject[i])&(Renamedsubject$label==j),(3:ncol(Renamedsubject))],mean))
}
}
SubjectFeatureMeans<-data.frame(SubjectFeatureMeans)
names(SubjectFeatureMeans)<-RepairedNames3
write.table(SubjectFeatureMeans,file="SubjectFeatureMeans.txt", row.name=FALSE)
test<-read.table(paste(dir1,"new2.txt",sep=""))
head(test)
SubjectFeatureMeans
names(SubjectFeatureMeans)<-RepairedNames3
write.table(SubjectFeatureMeans,file="SubjectFeatureMeans.txt", row.name=FALSE)
test<-read.table(file.path("D:", "sbu", "RLearning","Getting and Cleaning Data",
"programming", "UCI HAR Dataset", "new2.txt"))
head(test)
head(SubjectFeatureMeans)
?round
?round
round(0.987654321, digits = 4)
round(SubjectFeatureMeans, digits = 7)
c<-round(SubjectFeatureMeans, digits = 7)
head(c)
colnames
colnames(SubjectFeatureMeans)
class(SubjectFeatureMeans)
?data.frame
data.frame(1, 1:10, sample(L3, 10, replace = TRUE),digits=4)
?digits
head(test)
activity_labels$activity
tolower(as.charcter(activity_labels$activity))
tolower(as.character(activity_labels$activity)
tolower(as.character(activity_labels$activity))
tolower(as.character(activity_labels$activity))
?mean
UniqueSubject<-unique(Renamedsubject$subject)
UniqueActivity<-length(unique(Renamedsubject$label))
SubjectFeatureMeans<-matrix(rep(0,
length(UniqueSubject)*UniqueActivity*(ncol(Renamedsubject))),
(length(UniqueSubject)*UniqueActivity),(ncol(Renamedsubject)))
for (i in 1:length(UniqueSubject)){
for (j in 1:UniqueActivity){
c(i,tolower(as.character(activity_labels$activity[j])),
sapply(Renamedsubject[(Renamedsubject$subject==
UniqueSubject[i])&(Renamedsubject$label==j),(3:ncol(Renamedsubject))],mean))
}
}
SubjectFeatureMeans[(((i-1)*UniqueActivity)+j),]<-
SubjectFeatureMeans<-data.frame(SubjectFeatureMeans)
names(SubjectFeatureMeans)<-RepairedNames3
head(SubjectFeatureMeans)
UniqueSubject<-unique(Renamedsubject$subject)
UniqueActivity<-length(unique(Renamedsubject$label))
SubjectFeatureMeans<-matrix(rep(0,
length(UniqueSubject)*UniqueActivity*(ncol(Renamedsubject))),
(length(UniqueSubject)*UniqueActivity),(ncol(Renamedsubject)))
SubjectFeatureMeans
?makeVector
set <- function(y) {
x <<- y
m <<- NULL
}
library(party)
iris.model <- ctree(Species ~ . , data = train.set)
plot(iris.model)
iris.model <- ctree(Species ~ . , data = train.set)
alpha     <- 0.7 # percentage of training set
inTrain   <- sample(1:nrow(iris), alpha * nrow(iris))
train.set <- iris[inTrain,]
test.set  <- iris[-inTrain,]
iris.model <- ctree(Species ~ . , data = train.set)
plot(iris.model)
rnorm(100)
svd(rnorm(100)
sd(rnorm(100)
sd(rnorm(100))
sd(rnorm(100))
mean(rnorm(100))
Var1 <- runif(50, 0, 100)
sqrt.data <- data.frame(Var1, Sqrt=sqrt(Var1))
library(neuralnet)
net.sqrt <- neuralnet(Sqrt~Var1,  sqrt.data, hidden=10, threshold=0.01)
compute(net.sqrt, (1:10)^2)$net.result
setwd(file.path("D:", "sbu", "Rlearning",
"practical machine learning", "finalproject"))
##ISLR: library of datasets
library(ISLR); library(ggplot2);
library(caret);library(ElemStatLearn)
library(rpart)
set.seed(123)
##Reading Dataset
data <- read.csv("pml-training.csv", na.strings=c("#DIV/0!"))
CleanedData <- data
featuresnames <- colnames(CleanedData[colSums(is.na(CleanedData)) == 0])[-(1:7)]
features <- CleanedData[featuresnames]
TrainData <- createDataPartition(y=features$classe, p=3/4, list=FALSE )
training <- features[TrainData,]
testing <- features[-TrainData,]
temp<-features
temp$classe<-as.character(temp$classe)
temp$classe[temp$classe=="A"]=1
temp$classe[temp$classe=="B"]=2
temp$classe[temp$classe=="C"]=3
temp$classe[temp$classe=="D"]=4
temp$classe[temp$classe=="E"]=5
temp$classe<-as.numeric(temp$classe)
Traintemp <- createDataPartition(y=temp$classe, p=3/4, list=FALSE )
trainingtemp <- temp[Traintemp,]
testingtemp <- temp[-Traintemp,]
library(neuralnet)
model1 <- neuralnet(temp[,53]~temp[,1]+temp[,2]+temp[,3]+temp[,4]+
temp[,5]+temp[,6]+temp[,7]+temp[,8]+temp[,9]+
temp[,10]+temp[,11]+temp[,12]+temp[,13]+temp[,14]+
temp[,15]+temp[,16]+temp[,17]+temp[,18]+temp[,19]+
temp[,20]+temp[,21]+temp[,22]+temp[,23]+temp[,24]+
temp[,25]+temp[,26]+temp[,27]+temp[,28]+temp[,29]+
temp[,30]+temp[,31]+temp[,32]+temp[,33]+temp[,34]+
temp[,35]+temp[,36]+temp[,37]+temp[,38]+temp[,39]
, data=temp, hidden = 25, threshold = .09,
stepmax = 1e+05, rep = 2, startweights = NULL,
learningrate.limit = NULL,
learningrate.factor = list(minus = .5, plus = 1.2),
learningrate=NULL, lifesign = "full",
lifesign.step = 1000, algorithm = "rprop+",
err.fct = "ce", act.fct = "tanh",
linear.output = TRUE, exclude = NULL,
constant.weights = NULL, likelihood = FALSE)
library(neuralnet)
model1 <- neuralnet(temp[,53]~temp[,1]+temp[,2]+temp[,3]+temp[,4]+
temp[,5]+temp[,6]+temp[,7]+temp[,8]+temp[,9]+
temp[,10]+temp[,11]+temp[,12]+temp[,13]+temp[,14]+
temp[,15]+temp[,16]+temp[,17]+temp[,18]+temp[,19]+
temp[,20]+temp[,21]+temp[,22]+temp[,23]+temp[,24]+
temp[,25]+temp[,26]+temp[,27]+temp[,28]+temp[,29]+
temp[,30]+temp[,31]+temp[,32]+temp[,33]+temp[,34]+
temp[,35]+temp[,36]+temp[,37]+temp[,38]+temp[,39]
, data=temp, hidden = 25, threshold = .09,
stepmax = 1e+05, rep = 2, startweights = NULL,
learningrate.limit = NULL,
learningrate.factor = list(minus = .5, plus = 1.2),
learningrate=NULL, lifesign = "full",
lifesign.step = 1000, algorithm = "rprop+",
err.fct = "ce", act.fct = "tanh",
linear.output = TRUE, exclude = NULL,
constant.weights = NULL, likelihood = FALSE)
temp
featuresnames <- colnames(CleanedData[colSums(is.na(CleanedData)) == 0])[-(1:7)]
features <- CleanedData[featuresnames]
features
for(i in c(8:ncol(CleanedData)-1)) {CleanedData[,i] = as.numeric(as.character(CleanedData[,i]))}
featuresnames <- colnames(CleanedData[colSums(is.na(CleanedData)) == 0])[-(1:7)]
features <- CleanedData[featuresnames]
features
TrainData <- createDataPartition(y=features$classe, p=3/4, list=FALSE )
training <- features[TrainData,]
testing <- features[-TrainData,]
rm(training)
rm(testing)
temp<-features
temp$classe<-as.character(temp$classe)
temp$classe[temp$classe=="B"]=2
temp$classe[temp$classe=="A"]=1
temp$classe[temp$classe=="C"]=3
temp$classe[temp$classe=="D"]=4
temp$classe[temp$classe=="E"]=5
Traintemp <- createDataPartition(y=temp$classe, p=3/4, list=FALSE )
temp$classe<-as.numeric(temp$classe)
trainingtemp <- temp[Traintemp,]
testingtemp <- temp[-Traintemp,]
library(neuralnet)
model1 <- neuralnet(temp[,53]~temp[,1]+temp[,2]+temp[,3]+temp[,4]+
temp[,5]+temp[,6]+temp[,7]+temp[,8]+temp[,9]+
temp[,10]+temp[,11]+temp[,12]+temp[,13]+temp[,14]+
temp[,15]+temp[,16]+temp[,17]+temp[,18]+temp[,19]+
temp[,20]+temp[,21]+temp[,22]+temp[,23]+temp[,24]+
temp[,25]+temp[,26]+temp[,27]+temp[,28]+temp[,29]+
temp[,30]+temp[,31]+temp[,32]+temp[,33]+temp[,34]+
temp[,35]+temp[,36]+temp[,37]+temp[,38]+temp[,39]
, data=temp, hidden = 25, threshold = .09,
stepmax = 1e+05, rep = 2, startweights = NULL,
learningrate.limit = NULL,
learningrate.factor = list(minus = .5, plus = 1.2),
learningrate=NULL, lifesign = "full",
lifesign.step = 1000, algorithm = "rprop+",
err.fct = "ce", act.fct = "tanh",
linear.output = TRUE, exclude = NULL,
constant.weights = NULL, likelihood = FALSE)
library(neuralnet)
model1 <- neuralnet(temp[,53]~temp[,1]+temp[,2]+temp[,3]+temp[,4]+
temp[,5]+temp[,6]+temp[,7]+temp[,8]+temp[,9]+temp[,10]+temp[,11]+
temp[,12]+temp[,13]+temp[,14]+temp[,15]+temp[,16]+temp[,17]+
temp[,18]+temp[,19]+temp[,20]+temp[,21]+temp[,22]+temp[,23]+
temp[,24]+temp[,25]+temp[,26]+temp[,27]+temp[,28]+temp[,29]+
temp[,30]+temp[,31]+temp[,32]+temp[,33]+temp[,34]+temp[,35]+
temp[,36]+temp[,37]+temp[,38]+temp[,39]+temp[,40]+temp[,41]+
temp[,48]+temp[,49]+temp[,50]+temp[,51]+temp[,52], data=temp, hidden = 25,err.fct = "ce", lifesign = "full")
model1 <- neuralnet(temp[,53]~temp[,1]+temp[,2]+temp[,3]+temp[,4]+
temp[,5]+temp[,6]+temp[,7]+temp[,8]+temp[,9]+temp[,10]+temp[,11]+
temp[,18]+temp[,19]+temp[,20]+temp[,21]+temp[,22]+temp[,23]+
temp[,30]+temp[,31]+temp[,32]+temp[,33]+temp[,34]+temp[,35]+
temp[,42]+temp[,43]+temp[,44]+temp[,45]+temp[,46]+temp[,47]+
temp[,36]+temp[,37]+temp[,38]+temp[,39]+temp[,40]+temp[,41]+
temp[,24]+temp[,25]+temp[,26]+temp[,27]+temp[,28]+temp[,29]+
temp[,48]+temp[,49]+temp[,50]+temp[,51]+temp[,52], data=temp,
temp[,12]+temp[,13]+temp[,14]+temp[,15]+temp[,16]+temp[,17]+
hidden = 25,err.fct = "ce", rep = 1, lifesign = "full")
model1 <- neuralnet(temp[,53]~temp[,1]+temp[,2]+temp[,3]+temp[,4]+
temp[,5]+temp[,6]+temp[,7]+temp[,8]+temp[,9]+temp[,10]+temp[,11]+
temp[,12]+temp[,13]+temp[,14]+temp[,15]+temp[,16]+temp[,17]+
temp[,24]+temp[,25]+temp[,26]+temp[,27]+temp[,28]+temp[,29]+
temp[,30]+temp[,31]+temp[,32]+temp[,33]+temp[,34]+temp[,35]+
temp[,36]+temp[,37]+temp[,38]+temp[,39]+temp[,40]+temp[,41]+
temp[,48]+temp[,49]+temp[,50]+temp[,51]+temp[,52], data=temp,
temp[,42]+temp[,43]+temp[,44]+temp[,45]+temp[,46]+temp[,47]+
hidden = 25,err.fct = "ce", rep = 1, lifesign = "full")
temp[,18]+temp[,19]+temp[,20]+temp[,21]+temp[,22]+temp[,23]+
model1 <- neuralnet(temp[,53]~temp[,1]+temp[,2]+temp[,3]+temp[,4]+
temp[,5]+temp[,6]+temp[,7]+temp[,8]+temp[,9]+temp[,10]+temp[,11]+
temp[,12]+temp[,13]+temp[,14]+temp[,15]+temp[,16]+temp[,17]+
temp[,18]+temp[,19]+temp[,20]+temp[,21]+temp[,22]+temp[,23]+
temp[,24]+temp[,25]+temp[,26]+temp[,27]+temp[,28]+temp[,29]+
temp[,30]+temp[,31]+temp[,32]+temp[,33]+temp[,34]+temp[,35]+
temp[,36]+temp[,37]+temp[,38]+temp[,39]+temp[,40]+temp[,41]+
temp[,42]+temp[,43]+temp[,44]+temp[,45]+temp[,46]+temp[,47]+
temp[,48]+temp[,49]+temp[,50]+temp[,51]+temp[,52], data=temp,
hidden = 25,err.fct = "ce", rep = 1, lifesign = "full")
model1 <- neuralnet(temp[,53]~temp[,1]+temp[,2]+temp[,3]+temp[,4]+
temp[,5]+temp[,6]+temp[,7]+temp[,8]+temp[,9]+temp[,10]+temp[,11]+
temp[,12]+temp[,13]+temp[,14]+temp[,15]+temp[,16]+temp[,17]+
temp[,18]+temp[,19]+temp[,20]+temp[,21]+temp[,22]+temp[,23]+
temp[,24]+temp[,25]+temp[,26]+temp[,27]+temp[,28]+temp[,29]+
temp[,30]+temp[,31]+temp[,32]+temp[,33]+temp[,34]+temp[,35]+
temp[,36]+temp[,37]+temp[,38]+temp[,39]+temp[,40]+temp[,41]+
temp[,48]+temp[,49]+temp[,50]+temp[,51]+temp[,52], data=temp,
temp[,42]+temp[,43]+temp[,44]+temp[,45]+temp[,46]+temp[,47]+
hidden = 25,err.fct = "ce", rep = 1, lifesign = "full",stepmax = 1e+04)
model1 <- neuralnet(temp[,53]~temp[,1]+temp[,2]+temp[,3]+temp[,4]+
temp[,5]+temp[,6]+temp[,7]+temp[,8]+temp[,9]+temp[,10]+temp[,11]+
temp[,12]+temp[,13]+temp[,14]+temp[,15]+temp[,16]+temp[,17]+
temp[,18]+temp[,19]+temp[,20]+temp[,21]+temp[,22]+temp[,23]+
temp[,24]+temp[,25]+temp[,26]+temp[,27]+temp[,28]+temp[,29]+
temp[,30]+temp[,31]+temp[,32]+temp[,33]+temp[,34]+temp[,35]+
temp[,36]+temp[,37]+temp[,38]+temp[,39]+temp[,40]+temp[,41]+
temp[,42]+temp[,43]+temp[,44]+temp[,45]+temp[,46]+temp[,47]+
temp[,48]+temp[,49]+temp[,50]+temp[,51]+temp[,52], data=temp,
hidden = 25,err.fct = "ce", rep = 1, lifesign = "full",stepmax = 1e+04)
model1
summary(model1)
model1$err.fct
model1$err.fct
str(model1)
library(neuralnet)
model1 <- neuralnet(temp[,53]~temp[,1]+temp[,2]+temp[,3]+temp[,4]+
temp[,5]+temp[,6]+temp[,7]+temp[,8]+temp[,9]+temp[,10]+temp[,11]+
temp[,12]+temp[,13]+temp[,14]+temp[,15]+temp[,16]+temp[,17]+
temp[,18]+temp[,19]+temp[,20]+temp[,21]+temp[,22]+temp[,23]+
temp[,24]+temp[,25]+temp[,26]+temp[,27]+temp[,28]+temp[,29]+
temp[,30]+temp[,31]+temp[,32]+temp[,33]+temp[,34]+temp[,35]+
temp[,36]+temp[,37]+temp[,38]+temp[,39]+temp[,40]+temp[,41]+
temp[,42]+temp[,43]+temp[,44]+temp[,45]+temp[,46]+temp[,47]+
temp[,48]+temp[,49]+temp[,50]+temp[,51]+temp[,52], data=temp,
hidden = 25,err.fct = "ce", rep = 1, lifesign = "full",threshold = 20,stepmax = 1e+04)
model1 <- neuralnet(temp[,53]~temp[,1]+temp[,2]+temp[,3]+temp[,4]+
temp[,5]+temp[,6]+temp[,7]+temp[,8]+temp[,9]+temp[,10]+temp[,11]+
temp[,12]+temp[,13]+temp[,14]+temp[,15]+temp[,16]+temp[,17]+
temp[,18]+temp[,19]+temp[,20]+temp[,21]+temp[,22]+temp[,23]+
temp[,24]+temp[,25]+temp[,26]+temp[,27]+temp[,28]+temp[,29]+
temp[,30]+temp[,31]+temp[,32]+temp[,33]+temp[,34]+temp[,35]+
temp[,36]+temp[,37]+temp[,38]+temp[,39]+temp[,40]+temp[,41]+
temp[,42]+temp[,43]+temp[,44]+temp[,45]+temp[,46]+temp[,47]+
temp[,48]+temp[,49]+temp[,50]+temp[,51]+temp[,52], data=temp,
hidden = 25,err.fct = "ce", rep = 1, lifesign = "full",threshold = 20,stepmax = 1e+05)
pr.nn <- compute(model1,temp,rep=1)
model1
?compute
pr.nn <- compute(model1,temp,rep=1)
pr.nn <- compute(model1,training,rep=1)
pr.nn <- compute(model1,trainingtemp,rep=1)
pr.nn
