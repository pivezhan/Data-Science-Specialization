setwd(file.path("D:", "sbu", "RLearning", "exploratory data analysis","project2"))
# http://stackoverflow.com/questions/1181060

NEI <-readRDS("summarySCC_PM25.rds")
SCC <-readRDS("Source_Classification_Code.rds")
mergedData = merge(NEI,SCC,by.x="SCC" ,by.y="SCC",all=TRUE)
CoalData <- mergedData[grep("coal", tolower(as.character(mergedData$Short.Name))),]
CoalData1 <- CoalData[!is.na(CoalData$year),]
CoalData2 <- CoalData1[!is.na(CoalData1$Emissions),]
library(dplyr)
CoalDataByYear<-group_by(CoalData2,year)
CoalDataByYearSum<-summarize(CoalDataByYear, TotalEmission=sum(Emissions))
plot(CoalDataByYearSum$year, CoalDataByYearSum$TotalEmission, xlab="year", 
    ylab= "Total Coal Emission in USA",
    col = "red",type="l",main="Total Emission of Coal per year in USA", lwd = 10)
dev.copy(png, file = "plot4.png" ) ## Copy my plot to a PNG file
dev.off() ## closing the PNG device!
